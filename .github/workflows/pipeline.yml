name: SRE Portfolio CI Pipeline

# Trigger this pipeline every time code is pushed to the main branch
on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]

jobs:
  production-tests:
    name: Run Python SRE Sanity Checks
    runs-on: ubuntu-latest

    steps:
      - name: üì• Checkout Repository
        uses: actions/checkout@v4

      - name: üêç Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.10'

      - name: üß™ Run Automated Quality Gate
        run: |
          python -c "
          import os, sys
          
          print('--- Starting SRE Portfolio Sanity Checks ---')
          
          # 1. Check if the main HTML file exists
          html_path = 'html5up-strata/index.html'
          if not os.path.exists(html_path):
              print(f'‚ùå CRITICAL ERROR: {html_path} is missing!')
              sys.exit(1)
              
          # 2. Check if the avatar image exists
          image_path = 'html5up-strata/images/avatar.jpg'
          if not os.path.exists(image_path):
              print(f'‚ùå CRITICAL ERROR: Profile image {image_path} is missing!')
              sys.exit(1)
              
          # 3. Read the HTML file and verify critical tags are present
          with open(html_path, 'r', encoding='utf-8') as f:
              content = f.read()
              
              required_strings = ['Neelima Devulapalli', 'Site Reliability Engineer', '<footer']
              for req in required_strings:
                  if req not in content:
                      print(f'‚ùå QUALITY GATE FAILED: Missing required text -> {req}')
                      sys.exit(1)
                      
          print('‚úÖ All Python Quality Gates Passed! Code is healthy.')
          print('üöÄ Ready for Netlify Deployment.')
          "